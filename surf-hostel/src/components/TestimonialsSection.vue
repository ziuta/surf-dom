<template>
  <section class="py-16 bg-white">
    <div class="section-container">
      <h2 class="heading-md text-center mb-12">GUEST REVIEWS</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div v-for="(r, idx) in displayedReviews" :key="idx" class="bg-gray-50 p-8 rounded-lg shadow-md border-l-4 border-teal-600 fade-in transform transition hover:shadow-xl hover:-translate-y-1">
          <div class="flex gap-1 mb-3">
            <span class="text-yellow-400">‚≠ê</span>
            <span class="text-yellow-400">‚≠ê</span>
            <span class="text-yellow-400">‚≠ê</span>
            <span class="text-yellow-400">‚≠ê</span>
            <span class="text-yellow-400">‚≠ê</span>
          </div>
          <p class="text-gray-700 mb-4 italic">"{{ r.text }}"</p>
          <div>
            <p class="font-semibold text-gray-900">{{ r.name }}</p>
            <p class="text-gray-600 text-sm">{{ r.locale }}</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</template>

<script setup>
import { ref, onMounted } from 'vue'

const reviews = [
  {
    name: 'Jake',
    locale: 'UK',
    lang: 'en',
    text: `Sickest weekend ever! ü§ô Finally nailed my pop-up thanks to Konstantin, the guy is an absolute legend and knows the ocean inside out. The hostel vibe is super social, perfect if you're traveling solo. Cold beers on the terrace after a session = pure happiness. Coming back for sure!`
  },
  {
    name: 'Sarah',
    locale: 'UK',
    lang: 'en',
    text: `Such a hidden gem in Vung Tau. I was super nervous but Polina made me feel so safe in the water, she‚Äôs amazing! üåä We also went surfing with C·∫£nh and he took us to some local spots I would never find alone. No fancy BS, just good waves and great people. 10/10 recommend.`
  },
  {
    name: 'Dmitry',
    locale: 'RU',
    lang: 'ru',
    text: `–ö–æ—Å—Ç—è ‚Äî –º–∏—Ä–æ–≤–æ–π –º—É–∂–∏–∫, —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏! üî• –ü–æ–∫–∞–∑–∞–ª –≥–¥–µ –ª—É—á—à–∏–µ –≤–æ–ª–Ω—ã, –æ—Ç–∫–∞—Ç–∞–ª–∏ –Ω–∞ —É—Ä–∞, –±–µ–∑ –ª–∏—à–Ω–µ–π –≤–æ–¥—ã –∏ —Ç–µ–æ—Ä–∏–π. –í–µ—á–µ—Ä–æ–º –≤ —Ö–æ—Å—Ç–µ–ª–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –ø—Ä–æ—Å—Ç–æ –æ–≥–æ–Ω—å, —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –∫–∞–∫ –≤ –≥–æ—Å—Ç—è—Ö —É —Å—Ç–∞—Ä—ã—Ö –¥—Ä—É–∑–µ–π. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç–æ—è—â–∏–π —Å–µ—Ä—Ñ–∏–Ω–≥ –≤–æ –í—å–µ—Ç–Ω–∞–º–µ, –∞ –Ω–µ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–≤–æ–¥, –≤–∞–º —Ç–æ—á–Ω–æ —Å—é–¥–∞.`
  },
  {
    name: 'Elena',
    locale: 'RU',
    lang: 'ru',
    text: `–ü–æ–ª–∏–Ω–∞ –ø—Ä–æ—Å—Ç–æ —Å—É–ø–µ—Ä! –û—á–µ–Ω—å –±–æ—è–ª–∞—Å—å –≥–ª—É–±–∏–Ω—ã, –Ω–æ —Å –Ω–µ–π –≤–æ–æ–±—â–µ —Å–ø–æ–∫–æ–π–Ω–æ, –æ–±—ä—è—Å–Ω—è–µ—Ç –≤—Å—ë —á—ë—Ç–∫–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ. –ù–∞ –≤—Ç–æ—Ä–æ–π –¥–µ–Ω—å —è —É–∂–µ –ø–æ–π–º–∞–ª–∞ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –≤–æ–ª–Ω—É! üòç –•–æ—Å—Ç–µ–ª —É—é—Ç–Ω—ã–π, –≤–∏–¥ —Å —Ç–µ—Ä—Ä–∞—Å—ã –±–æ–º–±–∞. –†–µ–±—è—Ç–∞, —Å–ø–∞—Å–∏–±–æ –∑–∞ —ç–º–æ—Ü–∏–∏, —ç—Ç–æ –±—ã–ª –ª—É—á—à–∏–π –æ—Ç–ø—É—Å–∫!`
  },
  {
    name: 'Minh',
    locale: 'VN',
    lang: 'vn',
    text: `Tr·ªùi ∆°i vui x·ªâu m·ªçi ng∆∞·ªùi ∆°i! üåä L·∫ßn ƒë·∫ßu h·ªçc surf m√† th·∫ßy C·∫£nh h∆∞·ªõng d·∫´n si√™u c√≥ t√¢m, t√© l√™n t√© xu·ªëng nh∆∞ng c∆∞·ªùi banh n√≥c. Hostel view ƒë·∫πp, s·ªëng ·∫£o ch√°y m√°y lu√¥n. Ai mu·ªën ƒë·ªïi gi√≥ cu·ªëi tu·∫ßn th√¨ xu·ªëng ƒë√¢y l√† chu·∫©n b√†i nha. Must try!`
  },
  {
    name: 'Linh',
    locale: 'VN',
    lang: 'vn',
    text: `Vibe ·ªü ƒë√¢y chill ph·∫øt. üòé H·ªçc surf m·ªát nh∆∞ng ph√™, may m√† c√≥ team support nhi·ªát t√¨nh l·∫Øm. ƒê·ªì ƒÉn ngon, gi√° h·ª£p l√Ω cho sinh vi√™n. Th√≠ch nh·∫•t l√† kh√¥ng kh√≠ th√¢n thi·ªán, ai c≈©ng h√≤a ƒë·ªìng nh∆∞ ng∆∞·ªùi nh√†. H·∫πn g·∫∑p l·∫°i team s·ªõm n√®!`
  }
]

const displayedReviews = ref([])

function shuffleArray(a) {
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    ;[a[i], a[j]] = [a[j], a[i]]
  }
}

function noConsecutiveSameLang(arr) {
  for (let i = 1; i < arr.length; i++) {
    if (arr[i].lang === arr[i - 1].lang) return false
  }
  return true
}

onMounted(() => {
  // Try to shuffle so languages are not grouped; fallback to simple shuffle
  const copy = reviews.slice()
  let attempts = 0
  do {
    shuffleArray(copy)
    attempts++
  } while (!noConsecutiveSameLang(copy) && attempts < 20)

  displayedReviews.value = copy
})

</script>

<style scoped>
/* subtle card entrance */
.fade-in { animation: fadeIn 560ms ease both; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
</style>
